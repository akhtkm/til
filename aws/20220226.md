# AWS

## セキュアなアプリケーションとアーキテクチャの設計

Q. 以下の条件を満たすような実行すべきアクションは？

- プライベートサブネットで実行されているアプリケーション層のEC2インスタンスはインターネットからソフトウェアパッチをダウンロードする必要がある．
- ただし，インターネットから直接インスタンスにアクセスすることはできない．

A. 
- パブリックサブネットで**NATゲートウェイ**を作成する．
- インターネットトラフィック用のNAT ゲートウェイへのルートがある**カスタムルートテーブルを定義**する
- カスタムルートテーブルを プライベートサブネットに関連付ける．

### データセキュリティ

Q. 以下の要件を満たす**最もコスト効率の高い**データストレージソリューションは何か？

- クラウドに保存されているすべてのデータを，オンプレミスに保存された暗号化キーを使用して保管時に必ず暗号化する必要がある

A. 
- 顧客が提供するキー(SSE-C)を使用したサーバー側暗号化を使用する．
- クライアント側の暗号化を使用して，保存時の暗号化を提供する．

* 補足
  Amazon S3 はPUTリクエストで提供される暗号化キーを使用してオブジェクトサーバー側を暗号化できる
  Amazon S3 がオブジェクトを複合するには，GET リクエストに同じキーを指定する必要がある
  顧客には Amazon S3にアップロードしてダウンロード 後に複合化する前に，データクライアント側を暗号化するオプションもある．
  AWS SDKはプロセス合理化するS3暗号化クライアントを提供する．

## コスト最適化アーキテクチャの設計

Q. 以下の要件を満たす**最もコスト効率の高い**データストレージソリューションは何か？

- アクセスログを最低5年間保持する必要がある．
- 一度保存された後のデータにアクセスすることはほとんどない．
- 必要に応じて1日前に通知することでアクセスできるようにしたい．

A.
- Amazon S3 Glacier ディープアーカイブストレージにデータを保存する．
- ライフサイクルルールを使用して5年後にオブジェクトを削除する．

* 補足
  Amazon S3 Glacier Deep Archive: 最も廉価なS3 ストレージクラス

Q. 以下の条件のとき，**できる限りコスト効率の高い容量を提供できる**ソリューションを実装するためには何をすべきか？

- 実行に7時間かかり，10時間以内に完了する必要のある，中断できないジョブを実行する．
- 毎月末に需要が一時的に増加する．
- 現在のリソースの要領ではジョブが制限時間以内に終わらないと予想される．

A. 需要の高い期間中にオンデマンドインスタンスをデプロイする

* 補足
  スポットインスタンスは一番安価な選択肢だが，中断される可能性がある場合は使用できない．
  オンデマンドインスタンスでは，実行秒数に対して請求が行われる．

Amazon CloudFrontの料金は以下の要素で決定される

トラフィックの分散：データ転送とリクエストの価格は地域によって異なり，価格はコンテンツが配信されるエッジの場所によって異なる
リクエスト：（HTTPまたはHTTPS）の数と種類，およびリクエストがお壊れた地域
データ転送アウト：Amazon CloudFront エッジロケーションから転送されたデータ量
